reinforcements_close_by = {
    scope:province = {
        every_neighboring_province = {
            every_army_in_location = {
                limit = {
                    army_owner = {
                        is_friendly_to_me = yes
                    }
                }
                add = army_size
            }
        }
    }
}

reinforcements_nearby = {
    scope:province = {
        county = {
            every_county_province = {
                limit = {
                    NOR = {
                        this = scope:province
                        any_neighboring_province = {
                            this = scope:province
                        }
                    }
                }
                every_army_in_location = {
                    limit = {
                        army_owner = {
                            is_friendly_to_me = yes
                        }
                    }
                    add = army_size
                }
            }
            every_neighboring_county = {
                every_county_province = {
                    limit = {
                        NOT = {
                            any_neighboring_province = {
                                this = scope:province
                            }
                        }
                    }
                    every_army_in_location = {
                        limit = {
                            army_owner = {
                                is_friendly_to_me = yes
                            }
                        }
                        add = army_size
                    }
                }
            }
        }
    }
}

bbv_total_army_toughness = {
  value = total_army_toughness
}


bbv_total_combat_size = {
  every_combat_side = {
    add = side_max_army_size
  }
  multiply = 10
}

bbv_combat_strength = {
  every_combat_side = {
    add = side_strength
  }
  multiply = 1000
}

bbv_martial_for_levies = {
  value = 1
  add = {
    value = martial
    subtract = 8
    divide = 100
  }
}

bbv_total_army_toughness = {
  add = total_army_toughness
}

bbv_total_army_damage = {
  add = total_army_damage
}

bbv_total_combat_side_toughness = {
  scope:location = {
    every_army_in_location = {
      limit = {
        is_army_in_combat = yes
        army_owner = {
          OR = {
            this = root
            is_allied_in_war = root
          }
        }
      }
      add = total_army_toughness
    }
  }
}

bbv_total_combat_side_damage = {
  scope:location = {
    every_army_in_location = {
      limit = {
        is_army_in_combat = yes
        army_owner = {
          OR = {
            this = root
            is_allied_in_war = root
          }
        }
      }
      add = total_army_damage
    }
  }
}

bbv_defender_knights_toughness = {
  every_combat_side = {
    limit = {
      is_combat_side_attacker = no
    }
    every_side_knight = {
      add = {
        value = prowess
        multiply = 10
      }
    }
  }
}

bbv_defender_knights_damage = {
  every_combat_side = {
    limit = {
      is_combat_side_attacker = no
    }
    every_side_knight = {
      add = {
        value = prowess
        multiply = 150
      }
    }
  }
}

bbv_attacker_knights_toughness = {
  every_combat_side = {
    limit = {
      is_combat_side_attacker = yes
    }
    every_side_knight = {
      add = {
        value = prowess
        multiply = 10
      }
    }
  }
}


bbv_attacker_knights_damage = {
  every_combat_side = {
    limit = {
      is_combat_side_attacker = yes
    }
    every_side_knight = {
      add = {
        value = prowess
        multiply = 150
      }
    }
  }
}
